{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\n    //Module Specification Data\n    let sheet = workbook.getWorksheets()[0];\n\n    //Module Id\tStudent Email\n    //CMP6002B\tpzv17sbu@uea.ac.uk\n    //CMP6006A\tpzv17sbu@uea.ac.uk\n\n    let documentName = '\\'Student Emails.xlsx\\'';\n   \n    if (sheet.getTables().length == 0)\n    {\n      //error: table not exists\n      throw new Error(`\\r\\n\\r\\nTable does not exist in ${documentName }.\\r\\n`);\n    }\n\n    let table = sheet.getTables()[0];\n\n    let dataHeaders = table.getHeaderRowRange().getValues();\n\n    if (dataHeaders[0][0] != 'ModuleId')\n    {\n      //error: table header wrong module id \n      throw new Error(`\\r\\n\\r\\nCannot find Table Header 'Module Id' in ${documentName}.\\r\\n`);\n    }\n    if (dataHeaders[0][1] != 'StudentEmail') {\n        //error: table header wrong Student Email\n      throw new Error(`\\r\\n\\r\\nCannot find Table Header 'Student Email' in ${documentName}.\\r\\n`);\n    }\n\n    let dataTable = table.getRangeBetweenHeaderAndTotal().getValues();\n\n    let emailRegex = \"[a - z0 - 9!#$ %& '*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&' * +/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\";\n    for (let i = 0; i < dataTable.length;i++)\n    {\n        if (dataTable[i][0] == '' || dataTable[i][1] == '')\n        {\n          //error: empty row found in table at row i + 1\n          throw new Error(`\\r\\n\\r\\nEmpty value found in Table (Row ${i + 2})  in ${documentName}.\\r\\n`);\n        }\n\n        if (dataTable[i][1].toString().match(emailRegex) == null) {\n          throw new Error(`\\r\\n\\r\\nInvalid email address found in Table1 (Row ${i + 2}) in ${documentName}.\\r\\n`);\n        }\n    }\n\n  console.log('--> Sheet1 (Student Emails) is Valid');\n  return 'Success';\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}