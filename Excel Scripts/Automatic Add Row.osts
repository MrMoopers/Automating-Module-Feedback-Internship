{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook, results: object ) {\n    // Your code here\n    //let moduleId = 'CMP6002B';\n    //let moduleId = 'CMP6006A';\n\n  /**results = [\n    {\n      \"key\": \"ModuleId\",\n      \"value\": \"CMP6002B\"\n    },\n    {\n      \"key\": \"question1\",\n      \"value\": \"1\"\n    },\n    {\n      \"key\": \"question2\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question3\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question4\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question5\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question6\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question7\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"question8\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"additionalComments9\",\n      \"value\": \"1111\"\n    },\n    {\n      \"key\": \"question10\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question11\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question12\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"additionalComments13\",\n      \"value\": \"2222\"\n    },\n    {\n      \"key\": \"question14\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question15\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question16\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"additionalComments17\",\n      \"value\": \"3333\"\n    },\n    {\n      \"key\": \"question18\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question19\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question20\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"additionalComments21\",\n      \"value\": \"4444\"\n    },\n    {\n      \"key\": \"question22\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question23\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question24\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"additionalComments25\",\n      \"value\": \"55555\"\n    },\n    {\n      \"key\": \"question26\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question27\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question28\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"additionalComments29\",\n      \"value\": \"6666\"\n    },\n    {\n      \"key\": \"question30\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question31\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question32\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"additionalComments33\",\n      \"value\": \"7777\"\n    },\n    {\n      \"key\": \"question34\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question35\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question36\",\n      \"value\": \"1\"\n    },\n    {\n      \"key\": \"additionalComments37\",\n      \"value\": \"8888\"\n    },\n    {\n      \"key\": \"question38\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question39\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question40\",\n      \"value\": \"1\"\n    },\n    {\n      \"key\": \"additionalComments41\",\n      \"value\": \"9999\"\n    },\n    {\n      \"key\": \"question42\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question43\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question44\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"additionalComments45\",\n      \"value\": \"10 10 10 10\"\n    },\n    {\n      \"key\": \"question46\",\n      \"value\": \"2\"\n    },\n    {\n      \"key\": \"question47\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question48\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"additionalComments49\",\n      \"value\": \"htrhrthtr\"\n    },\n    {\n      \"key\": \"question50\",\n      \"value\": \"4\"\n    },\n    {\n      \"key\": \"question51\",\n      \"value\": \"3\"\n    },\n    {\n      \"key\": \"question52\",\n      \"value\": \"5\"\n    },\n    {\n      \"key\": \"additionalComments53\",\n      \"value\": \"ggffgf\"\n    }\n  ];\n  **/\n\n    //moduleId = 'CMP6006A';\n    // surveyTable = 2 or surveyTable = 3\n    //let surveyTable = 1\n\n    //console.log(moduleId);\n    //console.log('\\n\\n');\n    //console.log(html);\n\n    //Module Specification Data\n    let sheet = workbook.getWorksheet(\"Sheet1\");\n    let table = sheet.getTables()[0];\n\n    let data:Array<string> = [];\n\n    data.push(Date().toString());\n    //i skips the first three hidden values: the moduleId, SurveyType and AcademicYear passed as hidden inputs\n    for (let i = 3; i < Object.keys(results).length; i++  )\n    {\n        data.push(results[i]['value'])\n    }\n    console.log(data);\n    \n    table.addRow(null, data)\n\n  //Set a html thank you for submitting page\n  let htmlTemplateStart = `<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Web form</title>\n      <style>\n      /* Styling the Body element i.e. Color,\n      Font, Alignment */\n      body {\n        background-color: #EEEEEE;\n    font-family: Verdana;\n    text-align: center;\n  }\n\n  tr:nth-child(even) {\n    background-color: #f2f2f2;\n  }\n\n  /* Styling the Form (Color, Padding, Shadow) */\n  form {\n    background-color: #fff;\n    max-width: 500px;\n    margin: 50px auto;\n    padding: 30px 20px;\n    box-shadow: 2px 5px 10px rgba(0, 0, 0, 0.5);\n  }\n\n          /* Styling form-control Class */\n          .form-control {\n    text-align: left;\n    margin-bottom: 25px;\n  }\n\n          /* Styling form-control Label */\n          .form-control label {\n    display: block;\n    margin-bottom: 10px;\n  }\n\n          /* Styling form-control input,\n          select, textarea */\n          .form-control input,\n          .form-control select,\n          .form-control textarea {\n    border: 1px solid #777;\n    border-radius: 2px;\n    font-family: inherit;\n    padding: 10px;\n    display: block;\n    width: 95%;\n  }\n\n          /* Styling form-control Radio\n          button and Checkbox */\n          .form-control input[type=\"radio\"],\n          .form-control input[type=\"checkbox\"] {\n    display: inline-block;\n    width: auto;\n  }\n\n  /* Styling Button */\n  button {\n    background-color: #00aef0;\n    border: 1px solid #777;\n    border-radius: 2px;\n    font-family: inherit;\n    font-size: 21px;\n    display: block;\n    width: 100%;\n    margin-top: 50px;\n    margin-bottom: 20px;\n  }\n  </style></head><body><h1> Thanks!</h1><br><br><h3>Your response for ${results[0]['value']} was submitted.</h3></body></head></html>`;\n\n  return htmlTemplateStart;    \n}","description":"","parameterInfo":"{\"originalParameterOrder\":[{\"name\":\"results\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"results\"],\"properties\":{\"results\":{\"type\":\"object\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"string\"}}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}