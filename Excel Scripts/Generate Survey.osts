{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook, moduleId:string, html:string) {\n    // Your code here\n  //let moduleId = 'CMP6002B';\n  //let moduleId = 'CMP6006A';\n\n  //Temp\n  html = '<!DOCTYPE html>\\r\\n<html lang=\\\"en\\\">\\r\\n<head>\\r\\n    <meta charset=\\\"UTF-8\\\">\\r\\n    <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\">\\r\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\r\\n    <title>Web form</title>\\r\\n</head>\\r\\n<body>\\r\\n<h1> [@@ModuleId@@] @@ModuleName@@ - SEM2 Mid Semester Feedback</h1>\\r\\n    <form action=\\\"https://prod-161.westeurope.logic.azure.com:443/workflows/c94642a3df8b4b259fb2a04f9fccc2a0/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=NU5qzs5sASZHrBssWMu052fCcX-3zn5uxcOPstV4NYM\\\" method=\\\"POST\\\">\\r\\n        <input type=\\\"hidden\\\" name=\\\"ModuleId\\\" value=\\\"@@ModuleId@@\\\" />\\r\\n        \\r\\n        <table class=\\\"radio-table\\\">\\r\\n            <thead>\\r\\n                <tr>\\r\\n                    <th>Question</th>\\r\\n                    <th>Strongly Disagree</th>\\r\\n                    <th>Disagree</th>\\r\\n                    <th>Neither Agree or Disagree</th>\\r\\n                    <th>Agree</th>\\r\\n                    <th>Strongly Agree</th>\\r\\n                </tr>\\r\\n            </thead>\\r\\n            <tbody>\\r\\n                <tr>\\r\\n                    <td>I find the lectures useful for learning the material</td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"1\\\" name=\\\"question1\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"2\\\" name=\\\"question1\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"3\\\" name=\\\"question1\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"4\\\" name=\\\"question1\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"5\\\" name=\\\"question1\\\" required/></td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td>I find the labs useful for learning the material</td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"1\\\" name=\\\"question2\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"2\\\" name=\\\"question2\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"3\\\" name=\\\"question2\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"4\\\" name=\\\"question2\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"5\\\" name=\\\"question2\\\" required/></td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td>I think the module is well organised and runs smoothly</td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"1\\\" name=\\\"question3\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"2\\\" name=\\\"question3\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"3\\\" name=\\\"question3\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"4\\\" name=\\\"question3\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"5\\\" name=\\\"question3\\\" required/></td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td>Overall, I am satisfied with the quality of this module</td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"1\\\" name=\\\"question4\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"2\\\" name=\\\"question4\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"3\\\" name=\\\"question4\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"4\\\" name=\\\"question4\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"5\\\" name=\\\"question4\\\" required/></td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td>Overall, I found @@ModuleOrganiser@@ to be an engaging lecturer. also @@TA3@@ says hello!</td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"1\\\" name=\\\"question5\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"2\\\" name=\\\"question5\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"3\\\" name=\\\"question5\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"4\\\" name=\\\"question5\\\" required/></td>\\r\\n                    <td><input type=\\\"radio\\\" value=\\\"5\\\" name=\\\"question5\\\" required/></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n\\r\\n        <label for=\\\"html\\\">Any additional comments...</label><br>\\r\\n        <textarea rows = \\\"3\\\" cols = \\\"50\\\" name = \\\"additionalComments1\\\">\\r\\n            Enter your name\\r\\n         </textarea>\\r\\n\\r\\n\\r\\n    <button type=\\\"submit\\\">Submit</button>  \\r\\n    </form>\\r\\n</body>\\r\\n</html>\\r\\n\\r\\n\\r\\n';\n    moduleId = 'CMP6006A';\n\n  //console.log(moduleId);\n  //console.log('\\n\\n');\n  //console.log(html);\n\n\n  let sheet = workbook.getWorksheet(\"Sheet1\");\n  let data = sheet.getTables()[0].getRangeBetweenHeaderAndTotal().getValues();\n  let dataHeaders = sheet.getTables()[0].getHeaderRowRange().getValues();\n  console.log(dataHeaders);\n\n\n  let moduleRow = -1;\n  do {\n    moduleRow++;\n\n  } while (moduleRow < data.length && data[moduleRow][0] != moduleId)\n\n  let moduleName = data[moduleRow][1];\n  let moduleOrganiser = data[moduleRow][2];\n\n  let temp = '';\n  let numOccurrences = 0;\n  for (let i = 0; i < dataHeaders[0].length;i++ )\n  {\n    temp = '@@' + dataHeaders[0][i] + '@@';\n    //numOccurrences = (html.match(new RegExp(temp + 'g')) || []).length;\n    numOccurrences = html.split(temp).length - 1;\n    console.log(numOccurrences);\n\n    for (let j = 0; j < numOccurrences; j++)\n    {\n      html = html.replace(temp, data[moduleRow][i].toString());\n    }\n  }\n\n\n\n\n  console.log(html);\n\n  //console.log(moduleId);\n  //console.log(moduleName);\n  //console.log(moduleOrganiser);\n\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[{\"name\":\"moduleId\",\"index\":0},{\"name\":\"html\",\"index\":1}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"moduleId\",\"html\"],\"properties\":{\"moduleId\":{\"type\":\"string\"},\"html\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}